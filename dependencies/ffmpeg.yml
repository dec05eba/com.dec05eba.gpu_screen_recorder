name: ffmpeg
disabled: false
config-opts:
  - --enable-gpl
  - --enable-shared
  - --disable-static
  - --disable-debug
  - --disable-doc
  - --disable-programs
  - --disable-decoders
  - --disable-indevs
  - --disable-vdpau
  #- --disable-encoders
  - --disable-filters
  - --disable-amf
  - --disable-audiotoolbox
  - --disable-videotoolbox
  - --disable-vulkan
  - --disable-sdl2
  - --disable-autodetect
  - --disable-avdevice
  - --disable-dwt
  - --disable-lsp
  - --disable-faan
  - --disable-iamf
  - --disable-alsa
  - --disable-iconv
  - --disable-sndio
  - --disable-xlib
  - --disable-cuda-llvm
  - --disable-debug
  - --enable-filter=amix
  - --enable-nvenc
  - --enable-ffnvcodec
  - --enable-libopus
  - --enable-vaapi
  - --enable-libx264
cleanup:
  - /share/ffmpeg/examples
sources:
  - type: git
    url: https://git.ffmpeg.org/ffmpeg.git
    commit: 140fd653aed8cad774f991ba083e2d01e86420c7
    tag: n8.0
    x-checker-data:
      type: git
      tag-pattern: ^n([\d.]+)$
      versions:
        <: '9'
modules:
  - name: ffnvcodec
    no-autogen: true
    make-install-args:
      - PREFIX=${FLATPAK_DEST}
    cleanup:
      - '*'
    sources:
      - type: git
        url: https://github.com/FFmpeg/nv-codec-headers.git
        commit: 43d91706e097565f57b311e567f0219838bcc2f6
        tag: n11.1.5.3
        x-checker-data:
          type: git
          tag-pattern: ^n([\d.]+)$
          versions:
            <: '12'
  - name: libx264
    config-opts:
      - --disable-cli
      - --enable-shared
      - --disable-opencl
      - --disable-bashcompletion
      - --enable-strip
    no-autogen: true
    make-install-args:
      - PREFIX=${FLATPAK_DEST}
   # cleanup:
  #    - '*'
    sources:
      - type: git
        url: https://code.videolan.org/videolan/x264.git
        commit: b35605ace3ddf7c1a5d67a2eb553f034aef41d55
